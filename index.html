<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Calculadora de Horas Trabalhadas</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@100..900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>Calculadora de Horas Trabalhadas</h1>
      <br>
      <div class="controls">
        <div class="card">
          <div style="display:flex;flex-direction:column;gap:6px;width:100%;">
            <label style="font-size:0.875em;font-weight:500;">Horário padrão de trabalho:</label>
            <div style="display:flex;gap:6px;align-items:center;flex-wrap:wrap;">
              <input id="standardEntry" type="time" value="08:00" style="width:65px" title="Entrada">
              <span style="font-size:0.75em;color:#666;">→</span>
              <input id="standardLunchOut" type="time" value="12:00" style="width:65px" title="Saída almoço">
              <span style="font-size:0.75em;color:#666;">→</span>
              <input id="standardLunchIn" type="time" value="13:00" style="width:65px" title="Volta almoço">
              <span style="font-size:0.75em;color:#666;">→</span>
              <input id="standardExit" type="time" value="17:45" style="width:65px" title="Saída">
            </div>
            <div style="font-size:0.75em;color:#666;text-align:center;">
              Horas/dia: <span id="calculatedHours" style="font-weight:500;">8h45</span>
            </div>
          </div>
        </div>
        <div class="card">
          <label for="workSchedule" style="font-size:0.875em;font-weight:500;">Escala semanal</label>
          <select id="workSchedule" style="width:80px;margin-top:4px;">
            <option value="5x2">5x2</option>
            <option value="6x1">6x1</option>
            <option value="3x4">3x4</option>
            <option value="4x3">4x3</option>
          </select>
        </div>
        <div class="card">
          <label for="cycleStartDay" style="font-size:0.875em;font-weight:500;">Dia de início do ciclo</label>
          <input id="cycleStartDay" type="number" min="1" max="31" value="25" style="width:60px;margin-top:4px;">
        </div>
        <div class="card">
          <label for="rounding" style="font-size:0.875em;font-weight:500;">Arredondamento</label>
          <select id="rounding" style="margin-top:4px;min-width:140px;width:fit-content;max-width:240px">
            <option value="threshold10" selected>Ajuste CLT automático</option>
            <option value="nearest5">Arredondar para 5 min</option>
            <option value="nearest10">Arredondar para 10 min</option>
            <option value="nearest15">Arredondar para 15 min</option>
            <option value="none">Nenhum</option>
          </select>
        </div>
      </div>
    </header>

    <main class="calendar">
      <section class="card month">
        <div class="month-header">
          <div style="display:flex;gap:16px;align-items:center">
            <button id="prevMonth" class="nav-btn">◀</button>
            <div id="monthLabel" style="font-weight:600"></div>
            <button id="nextMonth" class="nav-btn">▶</button>
          </div>
          <div class="small">Clique em um dia para adicionar/editar horas</div>
        </div>

        <div class="weekdays">
          <div>Dom</div><div>Seg</div><div>Ter</div><div>Qua</div><div>Qui</div><div>Sex</div><div>Sáb</div>
        </div>
        <div id="days" class="days"></div>
      </section>

      <aside class="sidebar">
        <div class="card">
          <h3>Resumo do período</h3>
          <div class="totals">
            <div class="line"><span>Dias úteis (escala)</span><strong id="workDaysTotal">0</strong></div>
            <div class="line"><span>Horas previstas (contrato)</span><strong id="expectedTotal">0h00</strong></div>
            <div class="line"><span>Horas trabalhadas</span><strong id="workedTotal">0h00</strong></div>
            <div class="line"><span>Saldo (sobre/baixo)</span><strong id="balance">0h00</strong></div>
            <div class="line"><span>Horas/dia restantes</span><strong id="dailyNeeded">0h00</strong></div>
          </div>
        </div>

        <div class="card">
          <h3>Legenda</h3>
          <div class="small">
            <strong>Ajuste CLT automático:</strong> Diferenças de até 10 minutos em relação às horas contratuais (tanto para mais quanto para menos) são ajustadas para o valor contratual. Acima de 10 min, conta o tempo real trabalhado.<br><br>
            <strong>Escala semanal:</strong> 5x2 = 5 dias trabalho + 2 folga; 6x1 = 6 trabalho + 1 folga; etc.<br><br>
            <strong>Dia de início do ciclo:</strong> Define quando seu período de trabalho começa/termina (ex: dia 25 = do dia 25 ao dia 24 do próximo mês).
          </div>
        </div>

        <div class="card" id="dadosBotoes">
          <div id="exportBtns">
            <button id="exportJson" class="export-btn">Exportar</button>
            <button id="importJson" class="export-btn">Importar</button>
          </div>
          <button id="clearData" class="ghost">Limpar dados deste navegador</button>
          <input id="fileInput" type="file" accept="application/json" style="display:none">
        </div>
      </aside>
    </main>

    <footer>
      <div style="display:flex;flex-direction: row;justify-content: space-between;align-items: center;width:100%">
        <div>Dados salvos localmente no navegador. Você pode exportar um backup em JSON.</div>
        <div class="theme-selector">
          <label for="themeSelect">Tema:</label>
          <select id="themeSelect">
            <option value="light">Claro</option>
            <option value="dark">Escuro</option>
          </select>
        </div>
      </div>
      <div style="display:flex;flex-direction: row;justify-content: left;align-items: center;width:100%;margin-top:6px;">
        <a href="https://github.com/mozartsempiano/calculadora-horas-trabalhadas/">GitHub</a>
      </div>
    </footer>
  </div>

  <!-- modal -->
  <div id="modal" style="display:none" class="modal-backdrop">
    <div class="modal card">
      <h2 id="modalTitle">Editar dia</h2>
      <div class="form-grid">
        <div class="time-fields-container">
          <div>
            <label>Chegada</label>
            <input id="inTime" type="time">
          </div>
          <div>
            <label>Saída p/ almoço</label>
            <input id="outLunch" type="time">
          </div>
          <div>
            <label>Retorno do almoço</label>
            <input id="inLunch" type="time">
          </div>
          <div>
            <label>Saída</label>
            <input id="outTime" type="time">
          </div>
        </div>
        <div style="grid-column:1/3">
          <label>Observação</label>
          <input id="note" type="text" placeholder="ex: plantão, 1/2 expediente...">
        </div>
        <div style="grid-column:1/3">
          <label style="display: flex; align-items: center; gap: 8px;">
            <input id="isHoliday" type="checkbox"> Folga (precisa repor)
          </label>
        </div>
        <div style="grid-column:1/3">
          <label style="display: flex; align-items: center; gap: 8px;">
            <input id="isDayOff" type="checkbox"> Feriado (não precisa repor)
          </label>
        </div>
        <div style="grid-column:1/3">
          <label style="display: flex; align-items: center; gap: 8px;">
            <input id="modalIsSickLeave" type="checkbox"> Atestado Médico
          </label>
        </div>
        <div id="sick-leave-time" style="grid-column:1/3; display:none;">
          <label>Horas do Atestado (início - fim)</label>
          <div style="display:flex; gap:8px; align-items:center;">
            <input id="modalSickLeaveStart" type="time" style="flex:1;">
            <span>até</span>
            <input id="modalSickLeaveEnd" type="time" style="flex:1;">
          </div>
        </div>
      </div>
      <div class="actions">
        <button id="deleteDay" class="ghost">Remover</button>
        <button id="cancelModal" class="ghost">Fechar</button>
        <button id="saveDay" class="primary">Salvar</button>
      </div>
    </div>
  </div>

  <script src="assets/js/utils.js"></script>
  <script src="assets/js/calendar.js"></script>
  <script src="assets/js/app.js"></script>
</body>
</html>
